# Сервис обмена валют на FastAPI

Проект выполнен по [ТЗ](https://zhukovsd.github.io/python-backend-learning-course/projects/currency-exchange/) 
из [родмапа](https://zhukovsd.github.io/python-backend-learning-course/) Сергея Жукова. Является REST веб-сервисом, 
реализующим доступ к БД валют и обменных курсов, а также логику валютной конвертации.
Код проекта (пакет currency_exchange) старательно придерживается принципов чистой архитектуры и разделен по уровням 
на основании важности политик, за которые ответственны его части: доменная логика, варианты использования, 
порты и адаптеры.

Функционал сервиса:
- Регистрация клиентов сервиса
- Авторизация запросов при помощи jwt-токенов доступа
- Запрос всех валют и обменных курсов, имеющихся в БД сервиса
- Добавление и изменение обменных курсов, добавление валют
- Конвертация валюты
- Действия, доступные администратору - удаление валют и курсов, блокировка клиентов, управление категориями
клиентов-пользователей, управление токенами доступа клиентов-пользователей.

## Технологии 

- **Веб-фреймворк**: FastAPI
- **Авторизация/регистрация пользователей-клиентов**: jwt-based, пакет auth, собственный код проекта
- **Логирование внутри приложения**: logging из стандартной библиотеки python
- **База данных**: PostgreSQL + SQLAlchemy ORM
- **Миграции схемы данных**: alembic
- **Управление зависимостями, пакетный менеджер**: Poetry 
- **Юнит-тесты**: pytest
- **Форматирование кода**: ruff
- **Статический анализатор типов в коде**: mypy
- **Контейнеризация приложения**: Docker
- **Хост, деплой**: Ubuntu + Nginx (прокси-сервер) + gunicorn (сервер приложения) 


## Пакет auth
В пакете реализован функционал для аутентификации и авторизации источников запросов (клиентов сервиса).  
Применяется подход, основанный на json веб токенах.  
Для регистрации клиент обязан отправить запрос на специальный эндпойнт сервиса, после чего
можно осуществлять последующие запросы на получение/обновление токенов доступа.  
Сервис представляет refresh токены, необходимые для обновления токенов доступа по истечении срока их действия.
Реализован механизм черного списка токенов - возможен отзыв действующих токенов, а сервис имеет информацию о том, 
какие из токенов отозваны, а какие действуют. Если пользователь получает/обновляет токен доступа, 
все его действующие токены отзываются. Также, в целях защиты от несанкционированного доступа, 
будут отозваны все токены пользователя при попытке вторичного использования ранее задействованного
refresh-токена, и все, что останется сделать истинному пользователю для возобновления доступа к сервису - 
это пройти процесс аутентификации заново при помощи пароля и логина.
